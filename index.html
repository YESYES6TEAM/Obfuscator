<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SPRINGTRAP LEVEL 5</title>
<style>
body{background:#05010c;color:#b68cff;font-family:monospace}
textarea{width:100%;height:220px;background:#0d0620;color:#fff;border:1px solid #3c1a6e}
button{padding:12px 20px;background:#7a3cff;color:#fff;border:none;margin:10px 0}
</style>
</head>
<body>

<h2>SPRINGTRAP â€¢ LEVEL 5 VM OBFUSCATOR</h2>
<textarea id="i" placeholder="Lua input"></textarea>
<button onclick="obf()">OBFUSCATE</button>
<textarea id="o" placeholder="Protected output"></textarea>

<script>
const rn=()=>"_"+Math.random().toString(36).slice(2,9)
const ri=()=>Math.floor(Math.random()*9999)

function encStr(s,k){
 let o=[]
 for(let i=0;i<s.length;i++)
  o.push("\\"+(((s.charCodeAt(i)^k)+i*7)%256))
 return `"${o.join("")}"`
}

function encNum(n){
 let a=Math.floor(Math.random()*500)+1
 return `(${n+a}-${a})`
}

function obf(){
 let src=document.getElementById("i").value
 if(!src)return

 let key=Math.floor(Math.random()*200)+33

 let V=[...Array(40)].map(rn)

 let junk=""
 for(let i=0;i<30;i++)
  junk+=`local ${rn()}=${encNum(ri())};`

 let out=`-- PROTECTED BY SPRINGTRAP

local ${V[0]}=string.char
local ${V[1]}=string.byte
local ${V[2]}=table.insert
local ${V[3]}=table.concat
local ${V[4]}=bit32 or bit
local ${V[5]}=${V[4]}.bxor
local ${V[6]}=setmetatable

${junk}

local ${V[7]}={}
${V[7]}.__index=${V[7]}

function ${V[7]}:${V[8]}(${V[9]},${V[10]})
 local ${V[11]}={}
 for i=1,#${V[9]} do
  ${V[2]}(${V[11]},
   ${V[0]}(
    ${V[5]}(
     ${V[1]}(${V[9]},i),
     (${V[1]}(${V[10]},1+(i%#${V[10]}))+i*7)%256
    )
   )
  )
 end
 return ${V[3]}(${V[11]})
end

local ${V[12]}={
 ${encNum(1)},${encNum(3)},${encNum(7)},${encNum(11)},
 ${encNum(0)},${encNum(5)},${encNum(2)}
}

local ${V[13]}={
 [${encNum(1)}]=function(s,k) return s:${V[8]}(s,k) end,
 [${encNum(3)}]=function(s,k) return loadstring(s)(k) end,
 [${encNum(7)}]=function() return end end,
}

local ${V[14]}={
 [${encNum(0)}]=${encStr(src,key)}
}

local ${V[15]}=${V[6]}({},{
 __call=function(_,pc)
  local r=nil
  while true do
   pc=${V[12]}[(pc%#${V[12]})+1]
   local op=${V[13]}[pc]
   if op then
    r=op(${V[14]}[${encNum(0)}],${encStr("SPRINGTRAP",0)})
    if pc==${encNum(3)} then break end
   end
   if math.random()>2 then break end
  end
  return r
 end
})

for ${V[16]}=1,${encNum(3)} do
 for ${V[17]}=1,${encNum(2)} do end
end

${V[15]}(${encNum(1)})
`

 document.getElementById("o").value=out
}
</script>

</body>
</html>
